<% content_for(:title) { "#{@file_name} - Page Migration" } %>

<% content_for :head do %>
  <style>
    .highlight { background: #1e1e2e; color: #cdd6f4; }
    /* Base text */
    .highlight .w { color: #cdd6f4 } /* Text.Whitespace */
    /* Punctuation - braces, brackets, colons, commas */
    .highlight .p { color: #89b4fa } /* Punctuation */
    /* Strings - JSON values */
    .highlight .s { color: #a6e3a1 } /* String */
    .highlight .s1 { color: #a6e3a1 } /* Literal.String.Single */
    .highlight .s2 { color: #a6e3a1 } /* Literal.String.Double */
    /* JSON keys/attributes - make them stand out */
    .highlight .na { color: #f9e2af } /* Name.Attribute - JSON keys */
    .highlight .nt { color: #f9e2af } /* Name.Tag */
    .highlight .nl { color: #f9e2af } /* Name.Label - JSON keys */
    /* Numbers */
    .highlight .mi { color: #fab387 } /* Literal.Number.Integer */
    .highlight .mf { color: #fab387 } /* Literal.Number.Float */
    .highlight .mh { color: #fab387 } /* Literal.Number.Hex */
    .highlight .mo { color: #fab387 } /* Literal.Number.Oct */
    .highlight .l { color: #fab387 } /* Literal */
    /* Keywords - true, false, null */
    .highlight .k { color: #cba6f7 } /* Keyword */
    .highlight .kc { color: #cba6f7 } /* Keyword.Constant - true/false/null */
    .highlight .kd { color: #cba6f7 } /* Keyword.Declaration */
    .highlight .kn { color: #cba6f7 } /* Keyword.Namespace */
    .highlight .kp { color: #cba6f7 } /* Keyword.Pseudo */
    .highlight .kr { color: #cba6f7 } /* Keyword.Reserved */
    .highlight .kt { color: #cba6f7 } /* Keyword.Type */
    /* Comments */
    .highlight .c { color: #6c7086 } /* Comment */
    .highlight .c1 { color: #6c7086 } /* Comment.Single */
    .highlight .cm { color: #6c7086 } /* Comment.Multiline */
    /* Names */
    .highlight .n { color: #cdd6f4 } /* Name */
    .highlight .nb { color: #89dceb } /* Name.Builtin */
    .highlight .nc { color: #f9e2af } /* Name.Class */
    .highlight .nd { color: #89b4fa } /* Name.Decorator */
    .highlight .nf { color: #89b4fa } /* Name.Function */
    .highlight .nn { color: #f9e2af } /* Name.Namespace */
    .highlight .no { color: #fab387 } /* Name.Constant */
    .highlight .nv { color: #cdd6f4 } /* Name.Variable */
    /* Operators */
    .highlight .o { color: #89b4fa } /* Operator */
    .highlight .ow { color: #cba6f7 } /* Operator.Word */
    /* String variants */
    .highlight .sb { color: #a6e3a1 } /* Literal.String.Backtick */
    .highlight .sc { color: #a6e3a1 } /* Literal.String.Char */
    .highlight .sd { color: #6c7086 } /* Literal.String.Doc */
    .highlight .se { color: #f2cdcd } /* Literal.String.Escape */
    .highlight .sh { color: #a6e3a1 } /* Literal.String.Heredoc */
    .highlight .si { color: #f2cdcd } /* Literal.String.Interpol */
    .highlight .sx { color: #a6e3a1 } /* Literal.String.Other */
    .highlight .sr { color: #f5c2e7 } /* Literal.String.Regex */
    .highlight .ss { color: #a6e3a1 } /* Literal.String.Symbol */
    /* Prose styles for Markdown rendering */
    .prose { color: #333; line-height: 1.6; }
    .prose h1 { font-size: 1.75rem; font-weight: 700; margin: 1.5rem 0 1rem; border-bottom: 1px solid #ddd; padding-bottom: 0.5rem; }
    .prose h2 { font-size: 1.5rem; font-weight: 600; margin: 1.25rem 0 0.75rem; border-bottom: 1px solid #eee; padding-bottom: 0.25rem; }
    .prose h3 { font-size: 1.25rem; font-weight: 600; margin: 1rem 0 0.5rem; }
    .prose h4 { font-size: 1.1rem; font-weight: 600; margin: 0.75rem 0 0.5rem; }
    .prose p { margin: 0.75rem 0; }
    .prose ul, .prose ol { margin: 0.75rem 0; padding-left: 1.5rem; }
    .prose ul { list-style-type: disc; }
    .prose ol { list-style-type: decimal; }
    .prose li { margin: 0.25rem 0; }
    .prose a { color: #FFCD00; text-decoration: underline; }
    .prose a:hover { color: #000; }
    .prose code { background: #f5f5f5; padding: 0.15rem 0.3rem; border-radius: 0.25rem; font-size: 0.9em; }
    .prose pre { background: #1e1e2e; color: #cdd6f4; padding: 1rem; border-radius: 0.5rem; overflow-x: auto; margin: 1rem 0; }
    .prose pre code { background: none; padding: 0; }
    .prose blockquote { border-left: 4px solid #FFCD00; padding-left: 1rem; margin: 1rem 0; color: #666; font-style: italic; }
    .prose table { width: 100%; border-collapse: collapse; margin: 1rem 0; }
    .prose th, .prose td { border: 1px solid #ddd; padding: 0.5rem; text-align: left; }
    .prose th { background: #f5f5f5; font-weight: 600; }
    .prose hr { border: none; border-top: 1px solid #ddd; margin: 1.5rem 0; }
    .prose img { max-width: 100%; height: auto; border-radius: 0.5rem; }
  </style>
<% end %>

<div class="space-y-6">
  <nav class="text-sm text-wttj-gray-dark">
    <%= link_to "Exports", exports_path, class: "hover:text-wttj-black" %> /
    <%= link_to params[:id], export_path(params[:id]), class: "hover:text-wttj-black" %> /
    <span class="text-wttj-black"><%= @file_name %></span>
  </nav>

  <div class="flex items-center justify-between">
    <h1 class="text-2xl font-bold text-wttj-black font-mono"><%= @file_name %></h1>
    <div class="flex items-center gap-2">
      <span class="text-sm text-wttj-gray-medium">
        <%= number_to_human_size(@file_content.bytesize) %>
      </span>
    </div>
  </div>

  <% if @file_type == :markdown %>
    <div class="bg-white rounded-lg shadow-sm border border-wttj-gray-light overflow-hidden">
      <div class="p-4 border-b border-wttj-gray-light flex items-center justify-between">
        <span class="text-wttj-gray-dark text-sm font-mono"><%= params[:path] %></span>
        <span class="text-xs text-wttj-gray-medium uppercase"><%= @file_type %></span>
      </div>
      <div class="p-6 prose max-w-none">
        <%= render_markdown(@file_content) %>
      </div>
    </div>
  <% else %>
    <div class="bg-wttj-black rounded-lg shadow-sm overflow-hidden">
      <div class="p-4 border-b border-wttj-gray-darker flex items-center justify-between">
        <span class="text-wttj-gray-light text-sm font-mono"><%= params[:path] %></span>
        <span class="text-xs text-wttj-gray-medium uppercase"><%= @file_type %></span>
      </div>
      <div class="p-4 overflow-x-auto">
        <pre class="highlight font-mono text-sm leading-relaxed"><code><%= raw @highlighted_content %></code></pre>
      </div>
    </div>
  <% end %>
</div>
